<div class="container post">
  <div class="row h-100 mx-3 pt-3">
    <div class="col-2 my-auto text-center">
      <img class="w-75 ava" src="{{ tutorial.creator.avatar }}" alt="" />
    </div>
    <div class="col-6 px-3 my-auto">
      <div class="row">
        <div class="col-12">
          <h5 class="text">{{ tutorial.creator.name }}</h5>
        </div>
      </div>

      <div class="row h-100 px-3">
        <span class="my-auto text-secondary material-icons">
          schedule
        </span>
        <span class="text-secondary">{{ tutorial.createdHuman }}</span>
      </div>
    </div>

    <div class="col-2">
      <div class="">
        <!-- <i class=" float-left  fas fa-bullhorn"></i> -->
        <i class="float-left fas fa-chalkboard-teacher fa-4x m-2"></i>
      </div>
    </div>

    <div class="col-2 my-auto" *ngIf="tutorial.creator.id == user.id">
      <div class="col-4 ml-auto">
        <button
          mat-icon-button
          [matMenuTriggerFor]="menu"
          aria-label="Example icon-button with a menu"
        >
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu" xPosition="before">
          <div>
            <button (click)="onEditPost()" mat-menu-item>
              <mat-icon>create</mat-icon>
              <span>Edit Post</span>
            </button>
            <button (click)="onDeletePost()" mat-menu-item>
              <mat-icon>delete_sweep</mat-icon>
              <span>Delete Post</span>
            </button>
          </div>
        </mat-menu>
      </div>
    </div>
  </div>

  <div *ngIf="tutorial.tags">
    <div class="row mx-5">
      <div class="col-lg-6 col-xs-12 col-sm-12 p-3 align-self-center my-auto">
        <div class="row h-100">
          <button mat-button [routerLink]="['/tutorials']" class="tag mx-1" [queryParams]="{tags: tag.name}" *ngFor="let tag of tutorial.tags">{{tag.name}}</button>
        </div>
      </div>
    </div>
  </div>

  <div class="row h-100 mx-auto">
    <div class="col-8">
      <mat-label class="text" [hidden]="!editing">Edit Your Post</mat-label>
      <textarea
        class="mx-5"
        matInput
        [hidden]="!editing"
        [(ngModel)]="postBody"
      ></textarea>
    </div>
    <div class="col-2"></div>
    <div class="col-2 my-auto" [hidden]="!editing">
      <span class="text material-icons" (click)="onUpdatePost()">
        send
      </span>
    </div>
    <p class="lead mx-5" [hidden]="editing">{{ tutorial.body }}</p>
  </div>

  <div class="row h-100 mx-auto my-2" *ngIf="tutorial.files.length > 0">
    <div class="col-12 mx-auto">
      <div *ngFor="let file of tutorial.files">
        <div *ngIf="file.mime.startsWith('image')">
          <div class="row h-100">
            <div class="col-6">
              <!-- <img class="img-fluid my-3" src="{{file.url}}" alt="image"> -->
              <app-photo class="mx-5" [src]="file.url"></app-photo>
            </div>
            <!-- <div class="col-6">
				<img class="img-fluid my-3" src="{{file.url}}" alt="image">
			  </div> -->
          </div>
        </div>

        <div class="mx-5" *ngIf="file.mime.startsWith('video')" class="mx-5">
          <mat-video
            src="{{ file.url }}"
            [preload]="true"
            [keyboard]="false"
            [showFrameByFrame]="true"
            [fullscreen]="true"
            [download]="true"
            color="accent"
            spinner="spin"
          >
          </mat-video>
        </div>
        <div class="mx-5" *ngIf="file.mime.startsWith('audio')">
          <audio controls>
            <source src="{{ file.url }}" type="{{ file.mime }}" />
            Your browser does not support the audio element.
          </audio>
        </div>
        <div
          class="mx-5"
          *ngIf="
            !(
              file.mime.startsWith('image') ||
              file.mime.startsWith('video') ||
              file.mime.startsWith('audio')
            )
          "
        >
          <a href="{{ file.url }}" target="_self">{{ file.name }}</a>
        </div>
      </div>
    </div>
  </div>

  <div class="row h-100">
    <div class="col-10 my-auto">
      <mat-form-field class="example-full-width px-5">
        <mat-label>Leave a comment</mat-label>
        <textarea
          [(ngModel)]="comment"
          (input)="onCommenting($event)"
          rows="3"
          matInput
          placeholder="Ex. It makes me feel..."
        ></textarea>
      </mat-form-field>
    </div>
    <div class="col-2 my-auto">
      <span
        class="text material-icons"
        [hidden]="isEmpty"
        (click)="onAddComment(tutorial.id)"
      >
        send
      </span>
    </div>
  </div>

  <app-tutorial-comments
    [comments]="tutorial.comments"
    [postId]="tutorial.id"
    [group]="null"
    [resource]="resource"
  ></app-tutorial-comments>
</div>
